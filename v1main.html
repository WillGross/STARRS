<!DOCTYPE html>
<html>
  <head>
    <title>STARRS for Colby</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      /* Ref: https://stackoverflow.com/questions/953918/how-to-align-a-div-to-the-middle-horizontally-width-of-the-page */
      #map {
        height: 50%;
        width: 50%;
        position: absolute;
        top: 10%;
        left: 25%;
        background-color: grey;
      }
      
      #Links {
      	position: relative;
      	top: 60%;
      	left: 25%;
      }
      
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>

    <div id="header">
    <image src="https://alumni.colby.edu/s/1470/images/editor/original/colby.jpg" 
    ALT="Colby Banner" width=100% height=50 ></div>



    <div id="map"></div>
    <script>
      var map;
      function initMap() {
        var map = new google.maps.Map(document.getElementById('map'), {
          center: {lat:44.556, lng:-69.646},
          zoom: 14
        });

        var mainStString = '<div>173 Main St. & Appleton St.</div>';
        var gilmanStString = '<div>Gilman St.</div>';
        var diamondString = '<div>Diamond building</div>';
        var davisString = '<div>Davis Science Building</div>';
        
        var mainStWindow = new google.maps.InfoWindow({
            content: mainStString
        });
        
        var gilmanStWindow = new google.maps.InfoWindow({
            content: gilmanStString
        });
        
        var diamondWindow = new google.maps.InfoWindow({
            content: diamondString
        });
        
        var davisWindow = new google.maps.InfoWindow({
            content: davisString
        });
        
        var image = 'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png';
        var imageAnchorPt = new google.maps.Point(10, 10);
        
        var mainStLatLng = {lat: 44.550999, lng: -69.632022};
        var gilmanStLatLng = {lat: 44.553614, lng: -69.637182};
        var diamondLatLng = {lat: 44.562241, lng: -69.659671};
        var davisLatLng = {lat: 44.564428, lng: -69.658850};
        
        var markerIcon = {
            url: 'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png',
            labelOrigin: imageAnchorPt
        };
        
        var mainStMarker = new google.maps.Marker({
            position: mainStLatLng,
            map: map,
            icon: markerIcon,
            label: {
                text: 'M',
                color: '#0000FF',
                fontWeight: 'bold'
            }
        });

        var gilmanStMarker = new google.maps.Marker({
          position: gilmanStLatLng,
          map: map,
            icon: markerIcon,
            label: {
                text: 'G',
                color: '#0000FF',
                fontWeight: 'bold'
            }
        });

        var diamondStMarker = new google.maps.Marker({
          position: diamondLatLng,
          map: map,
            icon: markerIcon,
            label: {
                text: 'D',
                color: '#0000FF',
                fontWeight: 'bold'
            }
        });

        var davisStMarker = new google.maps.Marker({
          position: davisLatLng,
          map: map,
            icon: markerIcon,
            label: {
                text: 'D',
                color: '#0000FF',
                fontWeight: 'bold'
            }
        });
        
        mainStMarker.addListener('click', function() {
            mainStWindow.open(map, mainStMarker);
        });
        
        gilmanStMarker.addListener('click', function() {
            gilmanStWindow.open(map, gilmanStMarker);
        });
        
        diamondStMarker.addListener('click', function() {
            diamondWindow.open(map, diamondStMarker);
        });
        
        davisStMarker.addListener('click', function() {
            davisWindow.open(map, davisStMarker);
        });
        
        var shuttleSymbol = {
            path: google.maps.SymbolPath.FORWARD_CLOSED_ARROW,
            scale: 4,
            fillColor: '#5555FF',
            fillOpacity: 0.7,
            strokeWeight: 2,
            strokeColor: '#000000',
            strokeOpacity: 1
        };
        //MD ROUTE IS NOT CERTIAN, MAY BE CHANGES IF ROUTE IS NOT WHAT WAS ASSUMED
        //once full route is determined, reverse the order of all mdLatLong (for sake of naming convention) and modify shuttleCoords to reflect this name change
        //left off at intersection of north street and west street(mdLatLng_013). continue to trace back to main street stop
        //add points closer to mainstreet to the top, closer to davis to the bottom
        var mdLatLng_013 = {lat: 44.555473, lng: -69.636668};
        var mdLatLng_012 = {lat: 44.555925, lng: -69.637208};
        var mdLatLng_011 = {lat: 44.557130, lng: -69.638587};
        var mdLatLng_010 = {lat: 44.559904, lng: -69.642017};
        var mdLatLng_009 = {lat: 44.566237, lng: -69.649635};
        var mdLatLng_008 = {lat: 44.566873, lng: -69.650748};
        var mdLatLng_007 = {lat: 44.567625, lng: -69.654226};
        var mdLatLng_006 = {lat: 44.567412, lng: -69.656007};
        var mdLatLng_005 = {lat: 44.566998, lng: -69.657077};
        var mdLatLng_004 = {lat: 44.565952, lng: -69.658743};
        var mdLatLng_003 = {lat: 44.565225, lng: -69.659534};
        var mdLatLng_002 = {lat: 44.564955, lng: -69.659012};
        var mdLatLng_001 = {lat: 44.564604, lng: -69.659196};
        //stop reversing numbers here

        var ddLatLng_001 = {lat: 44.564518, lng: -69.658531};
        var ddLatLng_002 = {lat: 44.564701, lng: -69.658627};
        var ddLatLng_003 = {lat: 44.564955, lng: -69.659012};
        var ddLatLng_004 = {lat: 44.565225, lng: -69.659534};
        var ddLatLng_005 = {lat: 44.564460, lng: -69.660065};
        var ddLatLng_006 = {lat: 44.564047, lng: -69.660254};
        var ddLatLng_007 = {lat: 44.563372, lng: -69.660422};
        var ddLatLng_008 = {lat: 44.562982, lng: -69.660462};
        var ddLatLng_009 = {lat: 44.562531, lng: -69.660461};
        var ddLatLng_010 = {lat: 44.561865, lng: -69.660306};
        var ddLatLng_011 = {lat: 44.561975, lng: -69.659549};
        var ddLatLng_012 = {lat: 44.562118, lng: -69.659593};
        var ddLatLng_013 = {lat: 44.562267, lng: -69.659589};

        //DG ROUTE IS NOT CERTIAN, MAY BE CHANGED IF ROUTE DIFFERES FROM ASSUMEND ROUTE
        var dgLatLng_001 = {lat: 44.562064, lng: -69.659634};
        var dgLatLng_002 = {lat: 44.561983, lng: -69.659704};
        var dgLatLng_003 = {lat: 44.561908, lng: -69.660352};
        var dgLatLng_004 = {lat: 44.561336, lng: -69.660115};
        var dgLatLng_005 = {lat: 44.557957, lng: -69.658622};
        var dgLatLng_006 = {lat: 44.557434, lng: -69.658141};
        var dgLatLng_007 = {lat: 44.557197, lng: -69.657624};
        var dgLatLng_008 = {lat: 44.556345, lng: -69.654988};
        


        
        var shuttleCoords = [
            mainStLatLng,
            //reverse the order once all points have been determined
            mdLatLng_013,
            mdLatLng_012,
            mdLatLng_011,
            mdLatLng_010,
            mdLatLng_009,
            mdLatLng_008,
            mdLatLng_007,
            mdLatLng_006,
            mdLatLng_005,
            mdLatLng_004,
            mdLatLng_003,
            mdLatLng_002,
            mdLatLng_001,
            //stop reverseing order here
            davisLatLng,
            ddLatLng_001,
            ddLatLng_002,
            ddLatLng_003,
            ddLatLng_004,
            ddLatLng_005,
            ddLatLng_006,
            ddLatLng_007,
            ddLatLng_008,
            ddLatLng_009,
            ddLatLng_010,
            ddLatLng_011,
            ddLatLng_012,
            ddLatLng_013,
            diamondLatLng,
            dgLatLng_001,
            dgLatLng_002,
            dgLatLng_003,
            dgLatLng_004,
            dgLatLng_005,
            dgLatLng_006,
            dgLatLng_007,
            dgLatLng_008,
            gilmanStLatLng,
            mainStLatLng
        ];
        
        var shuttlePath = new google.maps.Polyline({
            path: shuttleCoords,
            icons: [{
                icon: shuttleSymbol,
                offset: '100%'
            }],
            geodesic: true,
            strokeColor: '#00FF00',
            strokeOpacity: 0.5,
            strokeWeight: 5
        });
        
        shuttlePath.setMap(map);
        animateCircle(shuttlePath);
        
      }
      
      // animation function copied from https://developers.google.com/maps/documentation/javascript/examples/overlay-symbol-animate
      // To change speed: mess up with the var "speed" and "200" in the last few lines.
      function animateCircle(line) {
      	var count = 0;
      	var speed = 5;
      	window.setInterval(function() {
      	    count = (count+1)%(speed*100);
      	    
      	    var icons = line.get('icons');
      	    icons[0].offset = (count/speed) + '%';
      	    line.set('icons', icons);
      	}, 200);
      }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBXLCCaUcKU-3hW_63p_op4CnEg8axVZgY&callback=initMap"
    async defer></script>
    
    <div id="Links">
    <a href="https://www.colby.edu/securitydept/colby-transportation-services/">
        Colby Transportation Services (security office webpage)</a>
    <br>
    <a href="http://www.colby.edu/securitydept/wp-content/uploads/sites/151/2017/09/Downtown-Shuttle-Schedule-and-Map-Sept2017.pdf">
        Colby Shuttle Schedule and Map</a>
    </div>
    
  </body>
</html>
